<!doctype html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="/images/favicon.png" />

<title>Optical tracking of vinyl records&nbsp;|&nbsp;Étienne&#39;s blog</title>
<meta
  name="title"
  content="Optical tracking of vinyl records"
/>
<meta
  name="description"
  content="We implemented an optical tracking method to measure the angular velocity of a vinyl record during playback, enabling the extraction of the time-warping ground truth from a filmed DJ performance. The method can be especially useful given the vast amount of videos of DJ performances online. By tracking a reference picture of a vinyl record to each frame of a video of a DJ turntable, the record&rsquo;s rotation speed can be estimated."
/>
<meta
  name="keywords"
  content=""
/>

  <meta name="author" content="Étienne André" />




<meta property="og:url" content="http://localhost:1313/posts/dj-transcription/vinyl-optical-tracking/">
  <meta property="og:site_name" content="Étienne&#39;s blog">
  <meta property="og:title" content="Optical tracking of vinyl records">
  <meta property="og:description" content="We implemented an optical tracking method to measure the angular velocity of a vinyl record during playback, enabling the extraction of the time-warping ground truth from a filmed DJ performance. The method can be especially useful given the vast amount of videos of DJ performances online. By tracking a reference picture of a vinyl record to each frame of a video of a DJ turntable, the record’s rotation speed can be estimated.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-09-26T14:48:48+02:00">
    <meta property="article:modified_time" content="2024-09-26T14:48:48+02:00">





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Optical tracking of vinyl records">
  <meta name="twitter:description" content="We implemented an optical tracking method to measure the angular velocity of a vinyl record during playback, enabling the extraction of the time-warping ground truth from a filmed DJ performance. The method can be especially useful given the vast amount of videos of DJ performances online. By tracking a reference picture of a vinyl record to each frame of a video of a DJ turntable, the record’s rotation speed can be estimated.">





  <meta itemprop="name" content="Optical tracking of vinyl records">
  <meta itemprop="description" content="We implemented an optical tracking method to measure the angular velocity of a vinyl record during playback, enabling the extraction of the time-warping ground truth from a filmed DJ performance. The method can be especially useful given the vast amount of videos of DJ performances online. By tracking a reference picture of a vinyl record to each frame of a video of a DJ turntable, the record’s rotation speed can be estimated.">
  <meta itemprop="datePublished" content="2024-09-26T14:48:48+02:00">
  <meta itemprop="dateModified" content="2024-09-26T14:48:48+02:00">
  <meta itemprop="wordCount" content="684">
<meta name="referrer" content="no-referrer-when-downgrade" />

    
    <link href="/simple.min.css" rel="stylesheet" />

    
    <link href="/style.min.css" rel="stylesheet" />

    

    
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
    MathJax = {
        tex: {
            displayMath: [['\\[', '\\]'], ['$$', '$$']],  
            inlineMath: [['\\(', '\\)'], ['$', '$']],      
            tags: 'ams'
        }
    };
</script>
</head>

  <body>
    <header>
      <nav>
  <a
    href="/"
    
    >Home</a
  >

  <a
    href="/posts/"
    
    >Posts</a
  >

  <a
    href="/publications/"
    
    >Publications</a
  >

  <a
    href="/resume/"
    
    >Resume</a
  >


  <a href="/index.xml">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 448 512">
      
      <path
        d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"
      />
    </svg>
    RSS
  </a>

</nav>

<h1>Optical tracking of vinyl records</h1>


    </header>
    <main>
      
  
  
  <content>
    <p>We implemented an optical tracking method to measure the angular velocity of a vinyl record during playback, enabling the extraction of the time-warping ground truth from a filmed DJ performance. The method can be especially useful given the vast amount of videos of DJ performances online. By tracking a reference picture of a vinyl record to each frame of a video of a DJ turntable, the record&rsquo;s rotation speed can be estimated.</p>
$$ 2+2 = 4 \frac{A}{B} $$<h2 id="tracking">Tracking</h2>
<p>The tracking is based on the scale-invariant feature transform (SIFT) algorithm @loweDistinctiveImageFeatures2004. The algorithm extracts keypoints from a reference image of the vinyl&rsquo;s label (@fig:vinyl-ref) and from each frame of a video of the vinyl being played. By matching these keypoints, a homography matrix is computed for each frame. This matrix represents the geometric transformation between the reference and the current frame, capturing the rotation, translation, and scale changes (@fig:vinyl-track). The sequence of homography matrices obtained across the frames is stored for further analysis.</p>
<figure><img src="/posts/dj-transcription/vinyl-optical-tracking/vinyl-ref.jpg"><figcaption>
      <h4>Reference image of the vinyl label.</h4>
    </figcaption>
</figure>

<video controls preload="auto" width="100%"  playsinline class="html-video">
    <source src="/posts/dj-transcription/vinyl-optical-tracking/out.mp4" type="video/mp4">
  <span>Your browser doesn't support embedded videos, but don't worry, you can <a href="/posts/dj-transcription/vinyl-optical-tracking/out.mp4">download it</a> and watch it with your favorite video player!</span>
</video>
<h2 id="extracting-the-rotation-angles-from-the-homography-matrix">Extracting the rotation angles from the homography matrix</h2>
<p>Each homography matrix</p>
<h2 id="rotation-computation">Rotation computation</h2>
<p>The stored homography matrices are then decomposed to extract the rotation angles of the vinyl record using the singular value decomposition method from #cite(<faugerasMOTIONSTRUCTUREMOTION1988>, form: &ldquo;prose&rdquo;) (section 7). The rotation on the $z$ axis corresponds to the rotation of the vinyl record. The rotation angle sequence is unwrapped then derived to obtain the rotation speed. Then, with knowledge of the nominal speed of the record (e.g. 33 or 45 rpm), the time-warping function can be calculated. Example results are illustrated in @fig:vinyl-results.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#cba6f7">def</span> <span style="color:#89b4fa">decompose_homography</span>(M):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>    <span style="color:#cba6f7">if</span> M <span style="color:#89dceb;font-weight:bold">is</span> <span style="color:#fab387">None</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>        <span style="color:#cba6f7">return</span> <span style="color:#fab387">0</span>, <span style="color:#fab387">0</span>, <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>    r1 <span style="color:#89dceb;font-weight:bold">=</span> M[<span style="color:#fab387">0</span>:<span style="color:#fab387">3</span>, <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>    r2 <span style="color:#89dceb;font-weight:bold">=</span> M[<span style="color:#fab387">0</span>:<span style="color:#fab387">3</span>, <span style="color:#fab387">1</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>    r3 <span style="color:#89dceb;font-weight:bold">=</span> np<span style="color:#89dceb;font-weight:bold">.</span>cross(r1, r2)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>    R <span style="color:#89dceb;font-weight:bold">=</span> np<span style="color:#89dceb;font-weight:bold">.</span>column_stack((r1, r2, r3))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>    U, S, Vt <span style="color:#89dceb;font-weight:bold">=</span> np<span style="color:#89dceb;font-weight:bold">.</span>linalg<span style="color:#89dceb;font-weight:bold">.</span>svd(R)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>    R <span style="color:#89dceb;font-weight:bold">=</span> np<span style="color:#89dceb;font-weight:bold">.</span>dot(U, Vt)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>    theta_x <span style="color:#89dceb;font-weight:bold">=</span> np<span style="color:#89dceb;font-weight:bold">.</span>arctan2(R[<span style="color:#fab387">2</span>, <span style="color:#fab387">1</span>], R[<span style="color:#fab387">2</span>, <span style="color:#fab387">2</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>    theta_y <span style="color:#89dceb;font-weight:bold">=</span> np<span style="color:#89dceb;font-weight:bold">.</span>arctan2(<span style="color:#89dceb;font-weight:bold">-</span>R[<span style="color:#fab387">2</span>, <span style="color:#fab387">0</span>], np<span style="color:#89dceb;font-weight:bold">.</span>sqrt(R[<span style="color:#fab387">2</span>, <span style="color:#fab387">1</span>] <span style="color:#89dceb;font-weight:bold">**</span> <span style="color:#fab387">2</span> <span style="color:#89dceb;font-weight:bold">+</span> R[<span style="color:#fab387">2</span>, <span style="color:#fab387">2</span>] <span style="color:#89dceb;font-weight:bold">**</span> <span style="color:#fab387">2</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>    theta_z <span style="color:#89dceb;font-weight:bold">=</span> np<span style="color:#89dceb;font-weight:bold">.</span>arctan2(R[<span style="color:#fab387">1</span>, <span style="color:#fab387">0</span>], R[<span style="color:#fab387">0</span>, <span style="color:#fab387">0</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>    <span style="color:#cba6f7">return</span> theta_x, theta_y, theta_z</span></span></code></pre></div>
<p>Given a homography matrix \( \mathbf{M} \), we can decompose it to retrieve the rotation matrix \( \mathbf{R} \) using the following steps:</p>
<ol>
<li>
<p>Assume \( \mathbf{M} \) can be expressed as:
</p>
\[
   \mathbf{M} = \begin{bmatrix}
   \mathbf{r}_1 & \mathbf{r}_2 & \mathbf{t} \\
   \end{bmatrix}
   \]<p>
where \( \mathbf{r}_1 \) and \( \mathbf{r}_2 \) are the first two columns of the rotation matrix \( \mathbf{R} \), and \( \mathbf{t} \) is the translation component.</p>
</li>
<li>
<p>Compute the third column \( r_3 \) of the rotation matrix as the cross product:
</p>
\[
   r_3 = r_1 \times r_2
   \]</li>
<li>
<p>Form the estimated rotation matrix:
</p>
\[
   \mathbf{R} = \begin{bmatrix}
   r_1 & r_2 & r_3 \\
   \end{bmatrix}
   \]</li>
<li>
<p>Perform Singular Value Decomposition (SVD) on \( \mathbf{R} \):
</p>
\[
   \mathbf{R} = \mathbf{U} \mathbf{S} \mathbf{V}^T
   \]</li>
<li>
<p>Correct \( \mathbf{R} \) to enforce orthonormality:
</p>
\[
   \mathbf{R} = \mathbf{U} \mathbf{V}^T
   \]</li>
<li>
<p>Extract the Euler angles \( (\theta_x, \theta_y, \theta_z) \) from the rotation matrix \( \mathbf{R} \):
</p>
\[
   \theta_x = \arctan2(R[2, 1], R[2, 2])
   \]\[
   \theta_y = \arctan2(-R[2, 0], \sqrt{R[2, 1]^2 + R[2, 2]^2})
   \]\[
   \theta_z = \arctan2(R[1, 0], R[0, 0])
   \]</li>
</ol>
<p>The angles \( \theta_x \), \( \theta_y \), \( \theta_z \) represent the rotation around the respective axes and allow us to retrieve the 3D rotations embedded within the homography transformation.</p>
<figure><img src="/posts/dj-transcription/vinyl-optical-tracking/rotato.svg"><figcaption>
      <h4>Computed angle and rotation speed of the vinyl. In the experiment, the record was played at 33 rpm for the first 30 seconds, then was &#34;scratched&#34; by hand for the remaining of the experiment.</h4>
    </figcaption>
</figure>

<p>The accuracy of the extracted rotational speed is directly dependent on the temporal resolution of the video (usually 30 or 60 images per second), which limits the granularity of the measurements. Additionally, the method is susceptible to noise introduced by the tracking process, which can affect the precision of the rotation and speed calculations.</p>
<p>Similar object tracking techniques could be used to extract ground truth data from any visible physical control of the DJ equipment.</p>

  </content>
  <p>
    
  </p>

    </main>
    <footer>
      
  <span>© 2024 Étienne André</span>



    </footer>

    
</body>
</html>
